<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23a08c6b' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.3;
        }

        .container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 480px;
            margin: 0 auto;
            background: #1a1a2e;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }

        /* Status Bar */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 20px;
            background: #16213e;
            color: white;
            font-size: 14px;
            font-weight: 500;
            min-height: 24px;
        }

        .status-left {
            font-weight: 600;
        }

        .status-right {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Header Bar */
        .header-bar {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .back-button {
            margin-right: 12px;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .back-button:hover {
            background: rgba(255,255,255,0.1);
        }

        .contact-info {
            flex: 1;
            display: flex;
            align-items: center;
        }

        .contact-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 12px;
            background: linear-gradient(135deg, #d4c5a0, #b8a082);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .contact-details h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .contact-details .status {
            margin: 0;
            font-size: 12px;
            color: #bdc3c7;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .header-actions button {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.2s;
        }

        .header-actions button:hover {
            background: rgba(255,255,255,0.1);
        }

        .envelope-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .envelope-container:hover {
            transform: translate(-50%, -50%) scale(1.05);
        }

        .envelope {
            width: 200px;
            height: 140px;
            position: relative;
            background: #f4f1e8;
            border: 2px solid #8b6f47;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.5s ease;
        }

        .envelope::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            height: 70px;
            background: #e8dcc6;
            border: 2px solid #8b6f47;
            border-bottom: none;
            clip-path: polygon(0 0, 50% 70%, 100% 0);
            z-index: 2;
        }

        .envelope::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            background: #d4c5a0;
            border-radius: 4px;
            opacity: 0.8;
        }

        .wax-seal {
            position: absolute;
            bottom: -15px;
            right: -15px;
            width: 40px;
            height: 40px;
            background: #8b2635;
            border-radius: 50%;
            border: 3px solid #6b1a28;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #d4c5a0;
            z-index: 3;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        }

        .envelope.opening {
            animation: envelopeOpen 0.8s ease-out forwards;
        }

        @keyframes envelopeOpen {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1) rotate(5deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(0) rotate(15deg);
                opacity: 0;
            }
        }

        /* Gandalf Image */
        .gandalf-image {
            position: relative;
            margin: 20px 0;
            margin-left: 20px;
            text-align: left;
            z-index: 10;
            display: none;
            pointer-events: none;
            max-width: calc(100% - 40px);
        }

        .gandalf-image img {
            width: auto;
            max-height: 40vh;
            max-width: 100%;
            object-fit: contain;
            display: block;
        }

        .grow-turn {
            animation: growTurn 1s ease-out forwards;
        }

        @keyframes growTurn {
            0% {
                opacity: 0;
                transform: scale(0.2) rotate(-360deg);
            }
            25% {
                opacity: 0.3;
                transform: scale(0.4) rotate(-270deg);
            }
            50% {
                opacity: 0.6;
                transform: scale(0.6) rotate(-180deg);
            }
            75% {
                opacity: 0.8;
                transform: scale(0.8) rotate(-90deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        /* Chat Area */
        .chat-area {
            display: none;
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: #1a1a2e;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 111, 71, 0.02) 0%, transparent 50%);
        }

        .date-separator {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }

        .date-separator span {
            background: rgba(255,255,255,0.1);
            color: #bdc3c7;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .message-bubble {
            max-width: 75%;
            margin: 4px 0;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            position: relative;
            word-wrap: break-word;
            line-height: 1.4;
        }

        .message-bubble.message-right {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            margin-left: auto;
            margin-right: 12px;
            border-bottom-right-radius: 4px;
            animation: slideInRight 0.3s ease-out;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .message-left {
            background: #2c2c54;
            color: #ecf0f1;
            margin-left: 52px;
            margin-right: auto;
            border-bottom-left-radius: 4px;
            animation: slideInLeft 0.3s ease-out;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .message-left::before {
            content: 'üßô‚Äç‚ôÇÔ∏è';
            position: absolute;
            left: -44px;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4c5a0, #b8a082);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .message-timestamp {
            font-size: 11px;
            color: rgba(255,255,255,0.6);
            margin-top: 4px;
            text-align: right;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 4px;
        }

        .message-left .message-timestamp {
            color: rgba(236,240,241,0.6);
            text-align: left;
            justify-content: flex-start;
        }

        .read-receipt {
            font-size: 12px;
            color: #3498db;
        }

        /* Input Area */
        .input-area {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #2c2c54;
            border-top: 1px solid rgba(255,255,255,0.1);
            gap: 12px;
        }

        .input-field {
            flex: 1;
            background: #1a1a2e;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 10px 16px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .input-field::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .input-actions {
            display: flex;
            gap: 8px;
        }

        .input-actions button {
            background: none;
            border: none;
            color: #bdc3c7;
            font-size: 18px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .input-actions button:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        @keyframes slideInRight {
            0% {
                opacity: 0;
                transform: translateX(50px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInLeft {
            0% {
                opacity: 0;
                transform: translateX(-50px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Fireworks Animation */
        .fireworks-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .firework {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: fireworkLaunch 2s linear forwards;
        }

        .firework.gold {
            background: #ffd700;
            box-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700;
        }

        .firework.blue {
            background: #4169e1;
            box-shadow: 0 0 20px #4169e1, 0 0 40px #4169e1;
        }

        .firework.red {
            background: #dc143c;
            box-shadow: 0 0 20px #dc143c, 0 0 40px #dc143c;
        }

        .firework.green {
            background: #32cd32;
            box-shadow: 0 0 20px #32cd32, 0 0 40px #32cd32;
        }

        .firework.purple {
            background: #8a2be2;
            box-shadow: 0 0 20px #8a2be2, 0 0 40px #8a2be2;
        }

        @keyframes fireworkLaunch {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            70% {
                opacity: 1;
            }
            100% {
                transform: translateY(-80vh);
                opacity: 0;
            }
        }

        .spark {
            position: fixed;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            pointer-events: none;
        }

        .spark.gold {
            background: #ffd700;
            box-shadow: 0 0 15px #ffd700;
        }

        .spark.blue {
            background: #4169e1;
            box-shadow: 0 0 15px #4169e1;
        }

        .spark.red {
            background: #dc143c;
            box-shadow: 0 0 15px #dc143c;
        }

        .spark.green {
            background: #32cd32;
            box-shadow: 0 0 15px #32cd32;
        }

        .spark.purple {
            background: #8a2be2;
            box-shadow: 0 0 15px #8a2be2;
        }

        @keyframes slowFadeIn {
            0% {
                opacity: 0;
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .rune-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
            opacity: 0;
        }

        .rune-image {
            width: 60px;
            height: auto;
            margin-bottom: 15px;
        }

        .rune-text {
            font-family: 'Georgia', serif;
            font-size: 20px;
            color: #d4af37;
            font-style: italic;
            text-align: center;
            text-shadow: 
                0 0 5px rgba(212, 175, 55, 0.8),
                0 0 10px rgba(212, 175, 55, 0.6),
                0 0 15px rgba(212, 175, 55, 0.4),
                2px 2px 4px rgba(0, 0, 0, 0.5);
            letter-spacing: 3px;
            font-weight: bold;
            text-transform: lowercase;
            line-height: 1.6;
            animation: textGlow 2s ease-in-out infinite alternate;
        }

        @keyframes textGlow {
            0% {
                text-shadow: 
                    0 0 5px rgba(212, 175, 55, 0.8),
                    0 0 10px rgba(212, 175, 55, 0.6),
                    0 0 15px rgba(212, 175, 55, 0.4),
                    2px 2px 4px rgba(0, 0, 0, 0.5);
            }
            100% {
                text-shadow: 
                    0 0 10px rgba(212, 175, 55, 1),
                    0 0 20px rgba(212, 175, 55, 0.8),
                    0 0 30px rgba(212, 175, 55, 0.6),
                    2px 2px 4px rgba(0, 0, 0, 0.5);
            }
        }

        /* Response Buttons - Modern messenger style */
        .response-button {
            background: linear-gradient(135deg, #8b6f47 0%, #6b5437 100%);
            color: #f4f1e8;
            border: none;
            padding: 14px 24px;
            border-radius: 25px;
            font-size: 15px;
            font-family: 'Georgia', serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 111, 71, 0.3);
            position: fixed;
            bottom: 25px;
            display: none;
            z-index: 1000;
            animation: fadeInUp 0.5s ease-out both;
            font-weight: 500;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(244, 241, 232, 0.2);
        }

        .response-button.left {
            left: calc(50% - 140px);
            transform: translateX(0);
            bottom: 25px;
        }

        .response-button.right {
            right: calc(50% - 140px);
            transform: translateX(0);
            bottom: 85px;
        }

        .response-button.center {
            left: 50%;
            transform: translateX(-50%);
        }

        .response-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(139, 111, 71, 0.4);
            background: linear-gradient(135deg, #9a7d57 0%, #7a6047 100%);
            scale: 1.02;
        }

        .response-button.left:hover {
            transform: translateX(0) translateY(-3px) scale(1.02);
        }

        .response-button.right:hover {
            transform: translateX(0) translateY(-3px) scale(1.02);
        }

        .response-button.center:hover {
            transform: translateX(-50%) translateY(-3px) scale(1.02);
        }

        .response-button:active {
            transform: translateY(-1px) scale(0.98);
        }

        .response-button.left:active {
            transform: translateX(0) translateY(-1px) scale(0.98);
        }

        .response-button.right:active {
            transform: translateX(0) translateY(-1px) scale(0.98);
        }

        .response-button.center:active {
            transform: translateX(-50%) translateY(-1px) scale(0.98);
        }

        /* Custom scrollbar - Modern style */
        .chat-area::-webkit-scrollbar {
            width: 6px;
        }

        .chat-area::-webkit-scrollbar-track {
            background: rgba(139, 111, 71, 0.1);
            border-radius: 10px;
        }

        .chat-area::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, rgba(139, 111, 71, 0.6), rgba(139, 111, 71, 0.8));
            border-radius: 10px;
        }

        .chat-area::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, rgba(139, 111, 71, 0.8), rgba(139, 111, 71, 1));
        }

        /* Message typing animation */
        @keyframes messageTyping {
            0% {
                opacity: 0;
                transform: translateY(10px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .message-bubble.typing {
            animation: messageTyping 0.4s ease-out;
        }

        /* Improved fade in animation */
        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translate(-50%, 15px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, 0) scale(1);
            }
        }

        @media (max-width: 480px) {
            .envelope {
                width: 160px;
                height: 112px;
            }
            
            .message-bubble {
                margin: 0 10px;
                max-width: 250px;
            }
            
            .response-button {
                padding: 10px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left" id="currentTime">4:05</div>
            <div class="status-right">
                <span>üîá</span>
                <span>üì∂</span>
                <span>üì∂</span>
                <span>üîã</span>
                <span>61%</span>
            </div>
        </div>

        <!-- Fireworks Container -->
        <div class="fireworks-container" id="fireworksContainer"></div>
        
        <div class="envelope-container" id="envelopeContainer" onclick="openEnvelope()">
            <div class="envelope" id="envelope">
                <div class="wax-seal">‚ú¶</div>
            </div>
        </div>

        <!-- Header Bar -->
        <div class="header-bar" id="headerBar" style="display: none;">
            <div class="back-button">‚Üê</div>
            <div class="contact-info">
                <div class="contact-avatar">üßô‚Äç‚ôÇÔ∏è</div>
                <div class="contact-details">
                    <h3>Gandalf the Grey</h3>
                    <p class="status" id="lastSeen">last seen at 3:45 PM</p>
                </div>
            </div>
            <div class="header-actions">
                <button>üìû</button>
                <button>‚ãÆ</button>
            </div>
        </div>
        
        <!-- Chat Area -->
        <div class="chat-area" id="chatArea">
            <div class="date-separator">
                <span id="currentDate">Today</span>
            </div>
            <div class="message-bubble message-left" id="firstMessage">
                Happy Birthday!
                <div class="message-timestamp" id="firstMessageTime"></div>
            </div>
            
            <!-- Gandalf Image -->
            <div class="gandalf-image" id="gandalfImage">
                <img src="./gandalf.png" alt="Gandalf" />
            </div>
        </div>

        <!-- Quick Replies Area -->
        <div class="quick-replies" id="quickReplies">
            <button class="response-button center" id="responseButton" onclick="handleResponse()">
                Good morning!
            </button>
            
            <button class="response-button center" id="thankYouButton" onclick="handleThankYouResponse()">
                Thank you!
            </button>
            
            <button class="response-button center" id="finalResponseButton" onclick="handleFinalResponse()">
                All of them at once, I suppose.
            </button>
            
            <button class="response-button center" id="helpResponseButton" onclick="handleHelpResponse()">
                Can I help you?? 
            </button>
            
            <button class="response-button center" id="nextResponseButton" onclick="handleNextResponse()">
                Of course you are!
            </button>
            
            <button class="response-button center" id="fireworksButton" onclick="handleFireworksResponse()">
                The wandering Wizard who made excellent fireworks
            </button>
            
            <button class="response-button center" id="oldTookButton" onclick="handleOldTookResponse()">
                Old Took used to have them on Midsummer's Eve.
            </button>
            
            <button class="response-button center" id="businessButton" onclick="handleBusinessResponse()">
                No idea you were still in business.
            </button>
        </div>

        <!-- Input Area -->
        <div class="input-area" id="inputArea" style="display: none;">
            <input type="text" class="input-field" placeholder="Message" readonly>
            <div class="input-actions">
                <button>üìé</button>
                <button>üé§</button>
            </div>
        </div>
    </div>

    <script>
        // Live timestamp functions
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            document.getElementById('currentTime').textContent = timeString;
        }

        function formatMessageTime() {
            const now = new Date();
            return now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        function formatDate() {
            const now = new Date();
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (now.toDateString() === today.toDateString()) return 'Today';
            else if (now.toDateString() === yesterday.toDateString()) return 'Yesterday';
            else return now.toLocaleDateString([], {month: 'long', day: 'numeric'});
        }

        function addTimestampToMessage(messageElement, isUser = false) {
            const timestamp = document.createElement('div');
            timestamp.className = 'message-timestamp';
            timestamp.innerHTML = formatMessageTime() + (isUser ? ' <span class="read-receipt">‚úì‚úì</span>' : '');
            messageElement.appendChild(timestamp);
        }

        function createUserMessage(text) {
            const chatArea = document.getElementById('chatArea');
            const userMessage = document.createElement('div');
            userMessage.className = 'message-bubble message-right';
            userMessage.textContent = text;
            addTimestampToMessage(userMessage, true);
            chatArea.appendChild(userMessage);
            chatArea.scrollTop = chatArea.scrollHeight;
            return userMessage;
        }

        function createGandalfMessage(text) {
            const chatArea = document.getElementById('chatArea');
            const gandalfMessage = document.createElement('div');
            gandalfMessage.className = 'message-bubble message-left';
            gandalfMessage.textContent = text;
            addTimestampToMessage(gandalfMessage);
            gandalfMessage.style.animation = 'slideInLeft 0.3s ease-out';
            chatArea.appendChild(gandalfMessage);
            chatArea.scrollTop = chatArea.scrollHeight;
            return gandalfMessage;
        }

        function styleButton(button, position = 'center') {
            button.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            button.style.color = 'white';
            button.style.border = 'none';
            button.style.padding = '8px 16px';
            button.style.borderRadius = '20px';
            button.style.fontSize = '13px';
            button.style.fontFamily = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif';
            button.style.cursor = 'pointer';
            button.style.fontWeight = '500';
            button.style.lineHeight = '1.3';
            button.style.whiteSpace = 'nowrap';
            button.style.textAlign = 'center';
            button.style.boxShadow = '0 2px 8px rgba(102, 126, 234, 0.3)';
            button.style.transition = 'all 0.3s ease';
            button.style.position = 'absolute';
            button.style.bottom = '12px';
            
            if (position === 'left') {
                button.style.left = '25%';
                button.style.transform = 'translateX(-50%)';
                button.style.right = 'auto';
            } else if (position === 'right') {
                button.style.right = '25%';
                button.style.transform = 'translateX(50%)';
                button.style.left = 'auto';
            } else {
                button.style.left = '50%';
                button.style.transform = 'translateX(-50%)';
            }
            
            button.style.display = 'block';
        }

        function openEnvelope() {
            const envelope = document.getElementById('envelope');
            const envelopeContainer = document.getElementById('envelopeContainer');
            const chatArea = document.getElementById('chatArea');
            const headerBar = document.getElementById('headerBar');
            const inputArea = document.getElementById('inputArea');
            const quickReplies = document.getElementById('quickReplies');
            const responseButton = document.getElementById('responseButton');
            const thankYouButton = document.getElementById('thankYouButton');
            const gandalfImage = document.getElementById('gandalfImage');
            
            envelope.classList.add('opening');
            
            setTimeout(() => {
                envelopeContainer.style.display = 'none';
                headerBar.style.display = 'flex';
                chatArea.style.display = 'block';
                quickReplies.style.display = 'block';
                inputArea.style.display = 'flex';
                
                document.getElementById('currentDate').textContent = formatDate();
                addTimestampToMessage(document.getElementById('firstMessage'));
                
                setTimeout(() => {
                    gandalfImage.style.display = 'block';
                    gandalfImage.classList.add('grow-turn');
                    
                    setTimeout(() => {
                        styleButton(responseButton, 'left');
                        styleButton(thankYouButton, 'right');
                    }, 1000);
                }, 1200);
            }, 800);
        }

        // Handlers
        function handleResponse() {
            createUserMessage('Good morning!');
            document.getElementById('responseButton').style.display = 'none';
            document.getElementById('thankYouButton').style.display = 'none';
            
            const gandalfResponses = [
                "What do you mean?",
                "Do you wish me a good morning",
                "or do you mean that it is a good morning whether I want it or not",
                "or that you feel good this morning",
                "or that it is a morning to be good on?"
            ];
            gandalfResponses.forEach((text, i) => {
                setTimeout(() => createGandalfMessage(text), (i+1)*1500);
            });

            setTimeout(() => {
                const finalButton = document.getElementById('finalResponseButton');
                styleButton(finalButton, 'center');
            }, gandalfResponses.length*1500 + 1000);
        }

        function handleThankYouResponse() {
            createUserMessage('Thank you!');
            document.getElementById('responseButton').style.display = 'none';
            document.getElementById('thankYouButton').style.display = 'none';
            
            const gandalfResponses = [
                "What do you mean?",
                "Do you thank me for the birthday wishes",
                "or do you mean that birthdays are worth thanking for",
                "or that you feel thankful this birthday",
                "or that this is a birthday to be thankful on?"
            ];
            gandalfResponses.forEach((text, i) => {
                setTimeout(() => createGandalfMessage(text), (i+1)*1500);
            });

            setTimeout(() => {
                const finalButton = document.getElementById('finalResponseButton');
                styleButton(finalButton, 'center');
            }, gandalfResponses.length*1500 + 1000);
        }

        function handleFinalResponse() {
            createUserMessage('All of them at once, I suppose.');
            document.getElementById('finalResponseButton').style.display = 'none';
            setTimeout(() => {
                const helpButton = document.getElementById('helpResponseButton');
                styleButton(helpButton, 'center');
            }, 1500);
        }

        function handleHelpResponse() {
            createUserMessage('Can I help you??');
            document.getElementById('helpResponseButton').style.display = 'none';
            setTimeout(() => {
                createGandalfMessage('I am looking for someone to share in an adventure.');
                setTimeout(() => {
                    const nextButton = document.getElementById('nextResponseButton');
                    styleButton(nextButton, 'center');
                }, 1500);
            }, 1500);
        }

        function handleNextResponse() {
            createUserMessage('Of course you are!');
            document.getElementById('nextResponseButton').style.display = 'none';
            setTimeout(() => {
                const fireworksButton = document.getElementById('fireworksButton');
                styleButton(fireworksButton, 'center');
            }, 1000);
        }

        function handleFireworksResponse() {
            createUserMessage('The wandering Wizard who made excellent fireworks');
            document.getElementById('fireworksButton').style.display = 'none';
            setTimeout(() => {
                const oldTookButton = document.getElementById('oldTookButton');
                styleButton(oldTookButton, 'center');
            }, 1000);
        }

        function handleOldTookResponse() {
            createUserMessage("Old Took used to have them on Midsummer's Eve.");
            document.getElementById('oldTookButton').style.display = 'none';
            setTimeout(() => {
                const businessButton = document.getElementById('businessButton');
                styleButton(businessButton, 'center');
            }, 1000);
        }

        function handleBusinessResponse() {
            createUserMessage('No idea you were still in business.');
            document.getElementById('businessButton').style.display = 'none';
            
            const gandalfMessages = [
                "Well, I'm pleased to find you remember something about me",
                "even if it's only my fireworks.",
                "Yes.",
                "Well, that's decided.",
                "It'll be very good for you and most amusing for me."
            ];
            
            gandalfMessages.forEach((text, i) => {
                setTimeout(() => {
                    createGandalfMessage(text);
                    if(text === "even if it's only my fireworks.") createFireworks();
                }, 1500 + i*1500);
            });

            setTimeout(() => {
                const chatArea = document.getElementById('chatArea');
                const stickerMessage = document.createElement('div');
                stickerMessage.className = 'message-bubble message-left';
                stickerMessage.style.background = 'transparent';
                stickerMessage.style.border = 'none';
                stickerMessage.style.padding = '10px';
                stickerMessage.style.animation = 'slideInLeft 0.6s ease-out';
                
                const stickerImg = document.createElement('img');
                stickerImg.src = './iwantyou.png';
                stickerImg.alt = 'I want you sticker';
                stickerImg.style.width = '200px';
                stickerImg.style.height = 'auto';
                stickerImg.style.borderRadius = '10px';
                
                stickerMessage.appendChild(stickerImg);
                chatArea.appendChild(stickerMessage);
                chatArea.scrollTop = chatArea.scrollHeight;
                
                setTimeout(() => {
                    const runeContainer = document.createElement('div');
                    runeContainer.className = 'rune-container';
                    runeContainer.style.display = 'flex';
                    runeContainer.style.animation = 'slowFadeIn 3s ease-in-out forwards';
                    
                    const runeImg = document.createElement('img');
                    runeImg.src = './rune.png';
                    runeImg.alt = 'Ancient Rune';
                    runeImg.className = 'rune-image';
                    
                    const runeText = document.createElement('div');
                    runeText.className = 'rune-text';
                    runeText.textContent = 'The team of heroes will be sent your way. Tempus veniet cum sol occidet';
                    
                    runeContainer.appendChild(runeImg);
                    runeContainer.appendChild(runeText);
                    chatArea.appendChild(runeContainer);
                    chatArea.scrollTop = chatArea.scrollHeight;
                }, 2000);
            }, 1500 + gandalfMessages.length*1500);
        }

        function createFireworks() {
            const container = document.getElementById('fireworksContainer');
            const colors = ['gold', 'blue', 'red', 'green', 'purple'];
            
            for (let i = 0; i < 12; i++) {
                setTimeout(() => {
                    launchFirework(container, colors);
                }, i * 200);
            }
        }

        function launchFirework(container, colors) {
            const firework = document.createElement('div');
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            firework.className = `firework ${color}`;
            firework.style.left = Math.random() * 90 + 5 + '%';
            firework.style.bottom = '0px';
            firework.style.position = 'absolute';
            
            container.appendChild(firework);
            
            setTimeout(() => {
                explodeFirework(firework, color, container);
            }, 1400);
            
            setTimeout(() => {
                if (firework.parentNode) {
                    firework.parentNode.removeChild(firework);
                }
            }, 2500);
        }

        function explodeFirework(firework, color, container) {
            const rect = firework.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for (let i = 0; i < 25; i++) {
                const spark = document.createElement('div');
                spark.className = `spark ${color}`;
                
                const angle = (i / 25) * Math.PI * 2;
                const velocity = 150 + Math.random() * 100;
                
                spark.style.left = centerX + 'px';
                spark.style.top = centerY + 'px';
                
                container.appendChild(spark);
                
                const deltaX = Math.cos(angle) * velocity;
                const deltaY = Math.sin(angle) * velocity;
                
                spark.animate([
                    { 
                        transform: 'translate(0, 0) scale(1)', 
                        opacity: 1 
                    },
                    { 
                        transform: `translate(${deltaX}px, ${deltaY}px) scale(0.2)`, 
                        opacity: 0 
                    }
                ], {
                    duration: 2500,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                setTimeout(() => {
                    if (spark.parentNode) {
                        spark.parentNode.removeChild(spark);
                    }
                }, 2500);
            }
        }

        // Start live clock and envelope float animation
        document.addEventListener('DOMContentLoaded', function() {
            // Update time every second
            updateTime();
            setInterval(updateTime, 1000);
            
            // Envelope floating animation
            const envelope = document.getElementById('envelope');
            if (envelope) {
                setInterval(() => {
                    if (!envelope.classList.contains('opening')) {
                        envelope.style.transform = 'translateY(' + Math.sin(Date.now() * 0.002) * 3 + 'px)';
                    }
                }, 50);
            }
        });
    </script>
</body>
</html>

